{{#VIEW}}
{{extend 'page_layout_new.html'}}
<div style="overflow-y:auto";>
	{{#=BEAUTIFY(my_inventory)}}
</div>

<table class="table table-striped table-hover">
	<thead>
		<tr>
			<td colspan="4">
				<div class="pull-left">
					<div class="input-group">
						<input id="vin_input" type="text" class="form-control" placeholder="Enter VIN Number">
						<span class="input-group-btn">
							<button id="vin_submit" class="btn btn-trinity"><i class="fa fa-fw fa-plus"></i>Add vehicle</button>
							<script>
								function activate_vin_submit(inp) {
									if (Boolean( inp.val() ) == false) {
										$("#vin_submit").removeClass("btn-info");
										$("#vin_submit").addClass("disabled btn-default");
									} else {
										$("#vin_submit").addClass("btn-info");
										$("#vin_submit").removeClass("disabled btn-default");
									}
								}
								activate_vin_submit($("#vin_input"));
								$("#vin_input").keyup(function(evt){
									activate_vin_submit($(evt.target));
								}).change(function(evt){
									activate_vin_submit($(evt.target));
								});
								$("#vin_submit").click(function(){
									window.location.href = "{{=URL('inventory', 'vin_decode') }}/" + $("#vin_input").val();
								});
							</script>
						</span>
					</div><!-- /input-group -->					
				</div>
				<div class="pull-right">
	
					{{#items per page}}
					<div class="btn-group">
					  	<button type="button" class="btn btn-default btn-sm dropdown-toggle text-uppercase text-sm" data-toggle="dropdown">
						    Per Page <i class="fa fa-caret-down"></i></span>
					  	</button>
					  	<ul class="dropdown-menu" role="menu">
							{{for each_limit in limits_list:}}
								{{_vars = dict(view=each_limit, sortby=request.vars['sortby'], show=request.vars['show'])}}
								<li><a href="{{=URL(vars=_vars)}}">{{=each_limit}} per page</a></li>
							{{pass}}
						</ul>
					</div>

					{{#sorting}}
					<div class="btn-group">
					  	<button type="button" class="btn btn-default btn-sm dropdown-toggle text-uppercase text-sm" data-toggle="dropdown">
						    Sort By <i class="fa fa-caret-down"></i></span>
					  	</button>
					  	<ul class="dropdown-menu" role="menu">
							{{for each_pair in sorting:}}
								{{for each_sort in each_pair:}}
									{{_vars.update(dict(sortby=each_sort, view=request.vars['view'] or 5, show=request.vars['show'],))}}
									{{sort_words = each_sort.split('-')}}
									<li><a href="{{=URL(vars=_vars)}}">{{=sort_words[0].replace('_',' ').capitalize()}}<i class="fa fa-angle-double-{{=sort_words[1]}} fa-fw"></i></a></li>
								{{pass}}
							{{pass}}
						</ul>
					</div>
					
					{{#show}}
					<div class="btn-group">
					  	<button type="button" class="btn btn-default btn-sm dropdown-toggle text-uppercase text-sm" data-toggle="dropdown">
						    Show <i class="fa fa-caret-down"></i></span>
					  	</button>
					  	<ul class="dropdown-menu" role="menu">
							{{for each_show in show_list:}}
								{{_vars.update(dict(show = each_show, sortby=request.vars['sortby'], view=request.vars['view'] or 5))}}
								<li><a href="{{=URL(vars=_vars)}}">{{=each_show.capitalize()}} vehicles</a></li>
							{{pass}}
						</ul>
					</div>	

				</div>
			</td>
		</tr>
		<tr>
			<th>Vehicle</th>
			<th>Trim</th>
			<th>Colors</th>
			<th>Action</th>
		</tr>
	</thead>
	<tbody>
		{{for each_offer in my_inventory:}}
			<tr>
				<td>
					<h4>{{=each_offer.year}} {{=each_offer.make_name}} {{=each_offer.model_name}} </h4>
					<h5>VIN: {{=each_offer.vin_number}} | ID: {{=str(each_offer.id).zfill(3)}}</h5>
				</td>
				<td>
					<h4>{{=each_offer.trim_name}}</h4>
					<h5>MSRP: ${{=each_offer.estimation()}} | <{{if len(each_offer.options):}}{{_tag="a"}}{{=_tag}} href="javascript:void(0)"{{else:}}{{_tag="span"}}{{=_tag}}{{pass}}  title="{{for each_option_name in each_offer.option_names:}}&#149; {{=each_option_name}}&#x0A;{{pass}}">{{=len(each_offer.options)}} options</{{=_tag}}></h5>
				</td>
				<td>
					<h4>Exterior: {{=COLOR_SWATCH(each_offer['exterior_color']['hex'], each_offer['exterior_color']['name'])}}</h4>
					<h5>Interior: {{=COLOR_SWATCH(each_offer['interior_color']['hex'], each_offer['interior_color']['name'])}}</h5>
				</td>
				<td>
					<a href="{{=URL('inventory','vehicle', args=[each_offer.year, each_offer.make, each_offer.model, each_offer.id])}}" class="btn btn-large btn-default" title="Edit"><i class="fa fa-fw fa-edit"></i></a>
					<a href="#" class="btn btn-large btn-default" title="Delete"><i class="fa fa-fw fa-trash-o"></i></a>
				</td>
			</tr>
		{{pass}}
	</tbody>
</table>