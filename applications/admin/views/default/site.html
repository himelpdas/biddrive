{{extend 'layout.html'}}
{{import os, glob}}

<table padding="5px"><tr><td width="60%">
<div class="main_panel">
<h3 class="section">{{=T("Installed applications")}}</h3>
{{for a in apps:}} 
<div class="application">
{{if a==request.application:}}
<h4><img src="{{=URL('static','folder_current.gif')}}"/>{{=a}}</h4>  
{{else:}}
<h4><img src="{{=URL('static','folder.gif')}}"/><a href="{{=URL(a,'default','index')}}">{{=a}}</a></h4> 
{{if not os.path.exists('applications/%s/compiled' % a):}}
<a class="button editbutton" href="{{=URL('design',args=a)}}">{{=T("edit")}}</a>
{{else:}}
<a class="button" href="{{=URL(a,'appadmin','index')}}">{{=T("appadmin")}}</a>
{{pass}}
<a class="button" href="{{=URL('about',args=a)}}">{{=T("about")}}</a>
{{pass}}
<a class="button" href="{{=URL('errors',args=a)}}">{{=T("errors")}}</a>
<a class="button" href="{{=URL('cleanup',args=a)}}">{{=T("clean")}}</a>
<a class="button" href="{{=URL('pack',args=a)}}">{{=T("pack all")}}</a>
{{if not os.path.exists('applications/%s/compiled' % a):}}
<a class="button" href="{{=URL('compile_app',args=a)}}">{{=T("compile")}}</a>
{{else:}}
<a class="button" href="{{=URL('pack',args=(a, 'compiled'))}}">{{=T("pack compiled")}}</a> 
{{if glob.glob('applications/%s/controllers/*.py' % a):}}
<a class="button" href="{{=URL('remove_compiled_app',args=a)}}">{{=T("remove compiled")}}</a> 
{{pass}}
{{pass}}
{{if a!=request.application:}}
<a class="button" href="{{=URL('uninstall',args=a)}}">{{=T("uninstall")}}</a> 
{{pass}}
<br/>
</div>
{{pass}}
<br/>
</div>

</td><td align="right">
<div class="right_aligned">
<a class="button" href="{{=URL('change_password')}}">{{=T('change admin password')}}</a>
</div>
<br/>
<div class="box">
<h3>{{=myversion}}</h3>
{{if session.check_version:}}
<div id="check_version">
{{=T('Checking for upgrades...')}}
</div>
<script>ajax('{{=URL('check_version')}}',[],'check_version');</script>{{session.check_version=False}}
{{else:}}
<div id="check_version">
{{=A(T('click to check for upgrades'),_class="button",_href="javascript:ajax('"+URL('check_version')+"',[],'check_version')")}}
</div>
{{pass}}
<a class="button" href="{{=URL('upgrade_web2py')}}">{{=T('upgrade web2py now')}}</a>
</div><br/>

<div class="box">
<h3>{{=T("New application wizard")}}</h3>
<a class="button" href="{{=URL('wizard','index')}}">{{=T('start wizard')}}</a>
{{=T("(requires internet access)")}}
</div><br/>

<div class="box">
<h3>{{=T("New simple application")}}</h3>
<form action="" enctype="multipart/form-data" method="post">{{=T("Application name:")}} <input name="filename" type="text" /> <button type="submit">{{=T('create')}}</button> <div class="hidden"></div></form>
</div><br/>


<div class="box">
<h3>{{=T("Upload & install packed application")}}</h3>
<form action="" enctype="multipart/form-data" method="post">
<table>
<tr>
<td>{{=T("Upload a package")}}</td>
<td><input id="file" name="file" type="file" /></td>
</tr>
<tr>
<td>{{=T("or provide app url:")}}</td>
<td><input id="appurl" name="appurl" type="text" /></td>
</tr>
<tr>
<td>{{=T("Rename (required):")}}</td>
<td><input id="url_filename" name="filename" type="text" /></td>
</tr>
<tr>
<td></td>
<td><input type="checkbox" name="overwrite_check"}}/> {{=T("overwrite installed app")}}</td>
</tr>
<tr>
<td></td>
<td><button type="submit">{{=T('install')}}</button></td>
</tr>
</table>
</form>
</div><br/>

<div class="box">
<h3>{{=T("Deploy on Google App Engine")}}</h3>
<a class="button" href="{{=URL(request.application,'gae','deploy')}}">deploy</a>
</div><br/>

<div class="box">
<h3>{{=T("web2py Recent Tweets")}}</h3>
<div id="tweets">{{=T('loading...')}}</div>
<script>
  jQuery(document).ready(function(){jQuery('#tweets').load('{{=URL('twitter')}}')});
</script>
</div><br/>
</td></tr></table>
