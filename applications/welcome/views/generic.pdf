{{
html = """ user a template here of user the line below """
html = response.render('%s/%s.html' % (request.controller,request.function))

import os
def image_map(path):
    if path.startswith('/%s/static/' % request.application):
         return os.path.join(request.folder,path.split('/',2)[2])    
    return 'http%s://%s%s' % (request.is_https and 's' or '',request.env.http_host, path)
from gluon.contrib.pyfpdf import FPDF, HTMLMixin
from gluon.sanitizer import sanitize
class MyFPDF(FPDF, HTMLMixin): pass
pdf=MyFPDF()
pdf.add_page()
html = sanitize(html, escape=False)
pdf.write_html(html,image_map=image_map)
response.headers['Content-Type']='application/pdf'
response.write(pdf.output(dest='S'), escape=False)
}}
